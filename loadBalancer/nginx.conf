http {
  upstream leaders {
    hash constant=abc123;
    server backend1.example.com max_fails=3 fail_timeout=30s;
    server backend2.example.com max_fails=3 fail_timeout=30s;
    server backend3.example.com max_fails=3 fail_timeout=30s;
  }

  upstream followers {
    server backend4.example.com;
    server backend5.example.com;
    server backend6.example.com;
  }

  server {
    listen 80;
    server_name example.com;

    location / {
      if ($request_method = POST) {
        proxy_pass http://leaders;
      }

      if ($request_method = GET) {
        proxy_pass http://followers;
      }
    }
  }
}